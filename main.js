!function(){"use strict";const e={inputSelector:".popup__info",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__info_type_error",errorClass:"popup__error_visible"};var t=class{constructor(e,t){var s,o;o=e=>e.some((e=>!e.validity.valid)),(s="_hasInvalidInput")in this?Object.defineProperty(this,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[s]=o,this._settings=e,this._formEl=t}_setEventListeners(e,t){e.forEach((s=>{s.addEventListener("input",(()=>{this._checkInputValidity(s),this._toggleButtonState(e,t)}))}))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(e,t){this._hasInvalidInput(e)?t.disabled=!0:t.disabled=!1}_showInputError(e){e.classList.add(this._settings.inputErrorClass);const t=e.validationMessage,s=e.id,o=this._formEl.querySelector("#".concat(s,"-error"));o.textContent=t,o.classList.add(this._settings.errorClass)}_hideInputError(e){e.classList.remove(this._settings.inputErrorClass);const t=e.id,s=this._formEl.querySelector("#".concat(t,"-error"));s.textContent="",s.classList.remove(this._settings.errorClass)}enableValidator(){const e=[...this._formEl.querySelectorAll(this._settings.inputSelector)],t=this._formEl.querySelector(this._settings.submitButtonSelector);this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(e,t)}resetValidation(){const e=[...this._formEl.querySelectorAll(this._settings.inputSelector)],t=this._formEl.querySelector(this._settings.submitButtonSelector);e.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState(e,t)}};class s{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._handleButtonClose=this._handleButtonClose.bind(this),this._handleOverlayClose=this._handleOverlayClose.bind(this),this._closeButton=this._popup.querySelector(".popup__close"),this._formList=[...this._popup.querySelectorAll(".popup__form")]}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleButtonClose(){this.close()}_handleOverlayClose(e){e.target===this._popup&&this.close()}open(){this._setEventListeners(),this._popup.classList.add("popup_open")}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keyup",this._handleEscClose),this._closeButton.removeEventListener("keyup",this._handleButtonClose),this._popup.removeEventListener("keyup",this._handleOverlayClose)}_setEventListeners(){document.addEventListener("keyup",this._handleEscClose),this._closeButton.addEventListener("mouseup",this._handleButtonClose),this._popup.addEventListener("mouseup",this._handleOverlayClose)}}class o extends s{constructor(e,t){var s,o;super(e),o=()=>{const e=this._getInputValues();this._handleFormSubmit(e),this.close()},(s="_handleSubmitClick")in this?Object.defineProperty(this,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[s]=o,this._handleFormSubmit=t,this._formList=[...this._popup.querySelectorAll(".popup__form")],this._formEl=this._popup.querySelector(".popup__form")}_getInputValues(){const e=[...this._popup.querySelectorAll(".popup__info")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}_setEventListeners(){this._formList.forEach((e=>{e.addEventListener("submit",this._handleSubmitClick)})),super._setEventListeners()}close(){super.close(),this._formEl.removeEventListener("submit",this._handleSubmitClick)}}const r=document.querySelector(".profile__edit-icon"),n=document.querySelector(".profile__add-icon"),i=document.querySelector("#popup"),l=document.querySelector(".popup_picture"),a=document.querySelector("#form-field-author"),c=document.querySelector("#form-field-picture"),u=document.querySelector("#popup-name"),p=document.querySelector("#popup-title");function _(e){const t=new class{constructor(e,t,s){this._imageLink=e.link,this._text=e.name,this._cardSelector=t,this._handleCardClick=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._cardElement.querySelector(".card__heart").addEventListener("mouseup",(e=>{this._handleLike(e)})),this._cardElement.querySelector(".card__trash").addEventListener("mouseup",(()=>{this._deleteCard()})),this._cardImage.addEventListener("mouseup",(e=>{this._handleCardClick(e.target)}))}_handleLike(e){e.target.classList.toggle("card__heart_active")}_deleteCard(){this._cardElement.remove(),this._cardElement=null}createCard(){this._cardElement=this._getTemplate(),this._cardImage=this._cardElement.querySelector(".card__img");const e=this._cardElement.querySelector(".card__place");return this._cardImage.alt=this._text,this._cardImage.src=this._imageLink,e.textContent=this._text,this._setEventListeners(),this._cardElement}}(e,"#card",m).createCard();f.addItem(t)}const d=new o(".popup_picture",((e,t)=>{!function(e){_(e)}(e)})),h=new class extends s{constructor(e){super(e)}open(e){const t=this._popup.querySelector(".popup__picture");t.src=e.src,t.alt=e.alt,this._popup.querySelector(".popup__popup-caption").textContent=e.alt,super.open()}}("#picture-popup");function m(e){h.open(e)}const E=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._nameSlot=document.querySelector(t),this._jobSlot=document.querySelector(s)}getUserInfo(){return{userName:this._nameSlot.textContent,userJob:this._jobSlot.textContent}}setUserInfo(e){this._nameSlot.textContent=e.userName,this._jobSlot.textContent=e.userJob}}({nameSelector:".profile__name",jobSelector:".profile__title"}),y=new o("#popup",(e=>{E.setUserInfo(e)})),S=new t(e,i);S.enableValidator();const v=new t(e,l);v.enableValidator(),n.addEventListener("mouseup",(function(){c.reset(),v.resetValidation(),d.open()})),r.addEventListener("mouseup",(function(){a.reset(),function(){const e=E.getUserInfo();u.value=e.userName,p.value=e.userJob}(),S.resetValidation(),y.open()}));const f=new class{constructor(e,t){let{items:s,renderer:o}=e;this._initialArray=s,this._container=document.querySelector(t),this._renderer=o}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.append(e)}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:_},".cards__container");f.renderItems()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFRaEQsaUJBQWlCLFdBTnpCLFdBQ0VvRCxFQUFpQjhDLFFBQ2pCRCxFQUF3QjVFLGtCQUN4QjBELEVBQVc1QyxVQUliWSxFQUFTL0MsaUJBQWlCLFdBcEIxQixXQUNFbUQsRUFBZ0IrQyxRQWJsQixXQUNFLE1BQU1DLEVBQVNmLEVBQVNLLGNBQ3hCcEMsRUFBaUJSLE1BQVFzRCxFQUFPVCxTQUNoQ3BDLEVBQWtCVCxNQUFRc0QsRUFBT1IsUUFXakNTLEdBQ0FMLEVBQXdCMUUsa0JBQ3hCeUUsRUFBYTNELFVBa0JmLE1BQU0wQyxFQUFjLElJL0VMLE1BQ2IxRixZQUFZLEVBQXFCa0gsR0FBbUIsSUFBeEMsTUFBRUMsRUFBRixTQUFTQyxHQUErQixFQUNsRDdHLEtBQUs4RyxjQUFnQkYsRUFDckI1RyxLQUFLK0csV0FBYWhGLFNBQVNYLGNBQWN1RixHQUN6QzNHLEtBQUtnSCxVQUFZSCxFQUVuQkksY0FDRWpILEtBQUs4RyxjQUFjekcsU0FBUzZHLElBQzFCbEgsS0FBS2dILFVBQVVFLE1BR25COUIsUUFBUStCLEdBQ05uSCxLQUFLK0csV0FBV0ssT0FBT0QsS0pvRXpCLENBQ0VQLE1KakZ3QixDQUMxQixDQUNFMUQsS0FBTSxrQkFDTmlCLEtBQU0sb0RBRVIsQ0FDRWpCLEtBQU0sY0FDTmlCLEtBQU0sdURBRVIsQ0FDRWpCLEtBQU0saUJBQ05pQixLQUFNLDBEQUVSLENBQ0VqQixLQUFNLFVBQ05pQixLQUFNLG1EQUVSLENBQ0VqQixLQUFNLHdCQUNOaUIsS0FBTSxtREFFUixDQUNFakIsS0FBTSxpQkFDTmlCLEtBQU0saURJMkROMEMsU0FBVWhELEdKOUNnQixxQklrRDlCc0IsRUFBWThCLGMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9hcm91bmRfdGhlX3VzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5mb1wiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgLy8gaW5wdXQgbGluZSBlcnJvciBzdHlsZVxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2luZm9fdHlwZV9lcnJvclwiLFxuICAvLyBlcnJvciBtZXNzYWdlIGNsYXNzXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5leHBvcnQgY29uc3QgY2FyZHNDb250YWluZXIgPSBcIi5jYXJkc19fY29udGFpbmVyXCI7XG5leHBvcnQgY29uc3QgY2FyZFNlbGVjdG9yID0gXCIjY2FyZFwiO1xuIiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycyhpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpIHtcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH1cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cbiAgX2hhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+XG4gICAgaW5wdXRMaXN0LnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIC8vIGNoYW5nZSB0ZWggaW5wdXQgc3R5bGUgdXBvbiBlcnJvclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIC8vIGVycm9yIG1lc3NhZ2UgY29udGVudFxuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgLy8gYWNjZXNzIHRoZSBpbnB1dCBpZCB3aGljaCBpcyBzb21ldGhpbmcgbGlrZSBwb3B1cC1kZXNjcmlwdGlvblxuICAgIGNvbnN0IGlucHV0SWQgPSBpbnB1dEVsLmlkO1xuICAgIC8vIHRoZSBpZCBvZiB0aGUgc3BhbiBzbG90IGlzIHRoZSB0ZW1wbGF0ZSBsaXRlcmFsXG4gICAgY29uc3QgZXJyb3JFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dElkfS1lcnJvcmApO1xuICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgZXJyb3JFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICB9XG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgY29uc3QgaW5wdXRJZCA9IGlucHV0RWwuaWQ7XG4gICAgY29uc3QgZXJyb3JFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dElkfS1lcnJvcmApO1xuICAgIGVycm9yRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgfVxuICBlbmFibGVWYWxpZGF0b3IoKSB7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gW1xuICAgICAgLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvciksXG4gICAgXTtcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgLy8gcHJldmVudCBhbGwgZm9ybXMgZnJvbSByZWZyZXNoaW5nIHRoZSBwYWdlIHVwb24gc3VibWl0XG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvLyBmb3IgYWxsIGZvcm1zLCB3ZSBuZWVkIHRvIHNldCBldmVudCBsaXN0ZW5lcnNcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyhpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xuICB9XG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBbXG4gICAgICAuLi50aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSxcbiAgICBdO1xuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcbiAgfVxufVxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlQnV0dG9uQ2xvc2UgPSB0aGlzLl9oYW5kbGVCdXR0b25DbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZSA9IHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIik7XG4gICAgdGhpcy5fZm9ybUxpc3QgPSBbLi4udGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZm9ybVwiKV07XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgX2hhbmRsZUJ1dHRvbkNsb3NlKCkge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgfVxuICBfaGFuZGxlT3ZlcmxheUNsb3NlKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuICBvcGVuKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlblwiKTtcbiAgfVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlblwiKTtcblxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUJ1dHRvbkNsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBUaHJlZSB3YXlzIHRvIGNsb3NlIHRoZSBwb3B1cDpcbiAgICAvLyAxKSBoaXQgRVNDIGtleVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgLy8gMikgbW91c2V1cCBvbiB0aGUgY2xvc2UgYnV0dG9uXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy5faGFuZGxlQnV0dG9uQ2xvc2UpO1xuICAgIC8vIDMpIG1vdXNldXAgb24gdGhlIG92ZXJsYXlcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIC8vIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSB0aGlzLl9oYW5kbGVGb3JtU3VibWl0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUxpc3QgPSBbLi4udGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZm9ybVwiKV07XG4gICAgdGhpcy5fZm9ybUVsID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgfVxuICAvLyBjcmVhdGUgYW5kIHJldHVybiBhbiBvYmplY3QgZnJvbSBhbGwgdGhlIGlucHV0IGJveGVzJyBhbnN3ZXJzXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBbLi4udGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5mb1wiKV07XG4gICAgY29uc3QgaW5wdXRDb250ZW50ID0ge307XG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0Q29udGVudFtpbnB1dEVsLm5hbWVdID0gaW5wdXRFbC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRDb250ZW50O1xuICB9XG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcbiAgICAgIGZvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdENsaWNrKTtcbiAgICB9KTtcblxuICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG4gIF9oYW5kbGVTdWJtaXRDbGljayA9ICgpID0+IHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG5cbiAgICAvL3dhaXQgdG8gYmUgcGFzc2VkIGluIGluIGluZGV4LmpzXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChpbnB1dFZhbHVlcyk7XG4gICAgdGhpcy5jbG9zZSgpO1xuICB9O1xuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm1FbC5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdENsaWNrKTtcbiAgfVxufVxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcbmltcG9ydCB7XG4gIGNhcmRzQ29udGFpbmVyLFxuICBjYXJkU2VsZWN0b3IsXG4gIGluaXRpYWxDYXJkcyxcbiAgc2V0dGluZ3MsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb25cIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlXCI7XG5cbi8vIHByb2ZpbGUgaWNvbnNcbmNvbnN0IGVkaXRJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWljb25cIik7XG5jb25zdCBhZGRJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtaWNvblwiKTtcbi8vIGF1dGhvciwgYWRkIHBpY3R1cmUgZm9ybXNcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBcIik7XG5jb25zdCBhZGRQaWN0dXJlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfcGljdHVyZVwiKTtcbi8vIGZvcm0gZmllbGRzIGZvciB0aGUgYXV0aG9yIGZvcm0gYW5kIHRoZSBhZGQgcGljdHVyZSBmb3JtXG5jb25zdCBmb3JtRmllbGRBdXRob3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0tZmllbGQtYXV0aG9yXCIpO1xuY29uc3QgZm9ybUZpZWxkUGljdHVyZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybS1maWVsZC1waWN0dXJlXCIpO1xuLy8gaW5wdXQgZmllbGRzIGZvciBwcm9maWxlIGZvcm0gcG9wdXBcbmNvbnN0IGlucHV0UHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLW5hbWVcIik7XG5jb25zdCBpbnB1dFByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXAtdGl0bGVcIik7XG5cbi8vIGFkZCBwaWN0dXJlIGZvcm0gZnVuY3Rpb25zXG5mdW5jdGlvbiByZW5kZXJDYXJkKGlucHV0VmFsdWVzKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChpbnB1dFZhbHVlcywgY2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2spO1xuICBjb25zdCBjYXJkRWwgPSBjYXJkLmNyZWF0ZUNhcmQoKTtcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xufVxuY29uc3QgcGxhY2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3BpY3R1cmVcIiwgKGV2dCwgaW5wdXRWYWx1ZXMpID0+IHtcbiAgaGFuZGxlUGljdHVyZUZvcm1TdWJtaXQoZXZ0LCBpbnB1dFZhbHVlcyk7XG59KTtcbmZ1bmN0aW9uIGhhbmRsZVBpY3R1cmVGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIHJlbmRlckNhcmQoaW5wdXRWYWx1ZXMpO1xufVxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwaWN0dXJlLXBvcHVwXCIpO1xuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGltYWdlKSB7XG4gIGltYWdlUG9wdXAub3BlbihpbWFnZSk7XG59XG5cbi8vIHByb2ZpbGUgZm9ybSBmdW5jdGlvbnNcbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcbiAgY29uc3QgcmVzdWx0ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgaW5wdXRQcm9maWxlTmFtZS52YWx1ZSA9IHJlc3VsdC51c2VyTmFtZTtcbiAgaW5wdXRQcm9maWxlVGl0bGUudmFsdWUgPSByZXN1bHQudXNlckpvYjtcbn1cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX19uYW1lXCIsXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxufSk7XG5jb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwb3B1cFwiLCAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpO1xufSk7XG5mdW5jdGlvbiBoYW5kbGVPcGVuUHJvZmlsZUZvcm0oKSB7XG4gIGZvcm1GaWVsZEF1dGhvci5yZXNldCgpO1xuICBmaWxsUHJvZmlsZUZvcm0oKTtcbiAgYWRkUHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XG59XG5cbi8vIHZhbGlkYXRvcnNcbmNvbnN0IGFkZFByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGVkaXRQcm9maWxlRm9ybSk7XG5hZGRQcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0b3IoKTtcbmNvbnN0IGFkZFBpY3R1cmVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGFkZFBpY3R1cmVGb3JtKTtcbmFkZFBpY3R1cmVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRvcigpO1xuXG5mdW5jdGlvbiBoYW5kbGVPcGVuQWRkUGljdHVyZUZvcm0oKSB7XG4gIGZvcm1GaWVsZFBpY3R1cmUucmVzZXQoKTtcbiAgYWRkUGljdHVyZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBsYWNlUG9wdXAub3BlbigpO1xufVxuXG5hZGRJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGhhbmRsZU9wZW5BZGRQaWN0dXJlRm9ybSk7XG5lZGl0SWNvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBoYW5kbGVPcGVuUHJvZmlsZUZvcm0pO1xuXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcbiAgfSxcbiAgY2FyZHNDb250YWluZXJcbik7XG5jYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGNhcmREYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaykge1xuICAgIHRoaXMuX2ltYWdlTGluayA9IGNhcmREYXRhLmxpbms7XG4gICAgdGhpcy5fdGV4dCA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgfVxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGhlYXJ0QnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydFwiKTtcbiAgICBoZWFydEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlKGV2dCk7XG4gICAgfSk7XG4gICAgY29uc3QgdHJhc2hCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpO1xuICAgIHRyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2RlbGV0ZUNhcmQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soZXZ0LnRhcmdldCk7XG4gICAgfSk7XG4gIH1cbiAgX2hhbmRsZUxpa2UoZXZ0KSB7XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9faGVhcnRfYWN0aXZlXCIpO1xuICB9XG4gIF9kZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfVxuICBjcmVhdGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltZ1wiKTtcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3BsYWNlXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl90ZXh0O1xuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9pbWFnZUxpbms7XG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IENhcmQ7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gIH1cbiAgb3BlbihpbWFnZSkge1xuICAgIGNvbnN0IGltYWdlRWwgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19waWN0dXJlXCIpO1xuICAgIGltYWdlRWwuc3JjID0gaW1hZ2Uuc3JjO1xuICAgIGltYWdlRWwuYWx0ID0gaW1hZ2UuYWx0O1xuICAgIGNvbnN0IGNhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19wb3B1cC1jYXB0aW9uXCIpO1xuICAgIGNhcHRpb24udGV4dENvbnRlbnQgPSBpbWFnZS5hbHQ7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZVNsb3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iU2xvdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICB9XG4gIC8vIHRvIHBvcHVsYXRlIGZvcm0gZmllbGRzIGFmdGVyIHBvcHVwIG9wZW5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXJOYW1lOiB0aGlzLl9uYW1lU2xvdC50ZXh0Q29udGVudCxcbiAgICAgIHVzZXJKb2I6IHRoaXMuX2pvYlNsb3QudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuICAvLyB1cG9uIGZvcm0gc3VibWlzc2lvblxuICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgdGhpcy5fbmFtZVNsb3QudGV4dENvbnRlbnQgPSBkYXRhLnVzZXJOYW1lO1xuICAgIHRoaXMuX2pvYlNsb3QudGV4dENvbnRlbnQgPSBkYXRhLnVzZXJKb2I7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheSA9IGl0ZW1zO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gIH1cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faW5pdGlhbEFycmF5LmZvckVhY2goKGFyckVsKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihhcnJFbCk7XG4gICAgfSk7XG4gIH1cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInNldHRpbmdzIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjb25zdHJ1Y3RvciIsImZvcm1FbCIsImlucHV0TGlzdCIsInNvbWUiLCJpbnB1dEVsIiwidmFsaWRpdHkiLCJ2YWxpZCIsInRoaXMiLCJfc2V0dGluZ3MiLCJfZm9ybUVsIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYnV0dG9uRWxlbWVudCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsImNsYXNzTGlzdCIsImFkZCIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRJZCIsImlkIiwiZXJyb3JFbCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsInJlbW92ZSIsImVuYWJsZVZhbGlkYXRvciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsImRvY3VtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVCdXR0b25DbG9zZSIsIl9oYW5kbGVPdmVybGF5Q2xvc2UiLCJfY2xvc2VCdXR0b24iLCJfZm9ybUxpc3QiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsImlucHV0VmFsdWVzIiwiX2dldElucHV0VmFsdWVzIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJpbnB1dENvbnRlbnQiLCJuYW1lIiwidmFsdWUiLCJfaGFuZGxlU3VibWl0Q2xpY2siLCJlZGl0SWNvbiIsImFkZEljb24iLCJlZGl0UHJvZmlsZUZvcm0iLCJhZGRQaWN0dXJlRm9ybSIsImZvcm1GaWVsZEF1dGhvciIsImZvcm1GaWVsZFBpY3R1cmUiLCJpbnB1dFByb2ZpbGVOYW1lIiwiaW5wdXRQcm9maWxlVGl0bGUiLCJyZW5kZXJDYXJkIiwiY2FyZEVsIiwiY2FyZERhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJfaW1hZ2VMaW5rIiwibGluayIsIl90ZXh0IiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRFbGVtZW50IiwiX2hhbmRsZUxpa2UiLCJfZGVsZXRlQ2FyZCIsIl9jYXJkSW1hZ2UiLCJ0b2dnbGUiLCJjcmVhdGVDYXJkIiwiY2FyZFRpdGxlIiwiYWx0Iiwic3JjIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwicGxhY2VQb3B1cCIsImhhbmRsZVBpY3R1cmVGb3JtU3VibWl0IiwiaW1hZ2VQb3B1cCIsImltYWdlIiwiaW1hZ2VFbCIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJfbmFtZVNsb3QiLCJfam9iU2xvdCIsImdldFVzZXJJbmZvIiwidXNlck5hbWUiLCJ1c2VySm9iIiwic2V0VXNlckluZm8iLCJkYXRhIiwicHJvZmlsZVBvcHVwIiwiYWRkUHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkUGljdHVyZUZvcm1WYWxpZGF0b3IiLCJyZXNldCIsInJlc3VsdCIsImZpbGxQcm9maWxlRm9ybSIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pbml0aWFsQXJyYXkiLCJfY29udGFpbmVyIiwiX3JlbmRlcmVyIiwicmVuZGVySXRlbXMiLCJhcnJFbCIsImVsZW1lbnQiLCJhcHBlbmQiXSwic291cmNlUm9vdCI6IiJ9