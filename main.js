!function(){"use strict";const e={inputSelector:".popup__info",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__info_type_error",errorClass:"popup__error_visible"};var t=class{constructor(e,t){var s,r;r=e=>e.some((e=>!e.validity.valid)),(s="_hasInvalidInput")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._settings=e,this._formEl=t}_setEventListeners(e,t){e.forEach((s=>{s.addEventListener("input",(()=>{this._checkInputValidity(s),this._toggleButtonState(e,t)}))}))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(e,t){this._hasInvalidInput(e)?t.disabled=!0:t.disabled=!1}_showInputError(e){e.classList.add(this._settings.inputErrorClass);const t=e.validationMessage,s=e.id,r=this._formEl.querySelector("#".concat(s,"-error"));r.textContent=t,r.classList.add(this._settings.errorClass)}_hideInputError(e){e.classList.remove(this._settings.inputErrorClass);const t=e.id,s=this._formEl.querySelector("#".concat(t,"-error"));s.textContent="",s.classList.remove(this._settings.errorClass)}enableValidator(){const e=[...this._formEl.querySelectorAll(this._settings.inputSelector)],t=this._formEl.querySelector(this._settings.submitButtonSelector);this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(e,t)}resetValidation(){const e=[...this._formEl.querySelectorAll(this._settings.inputSelector)],t=this._formEl.querySelector(this._settings.submitButtonSelector);e.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState(e,t)}};class s{constructor(e,t){let{items:s,renderer:r}=e;this._initialArray=s,this._container=document.querySelector(t),this._renderer=r}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._handleButtonClose=this._handleButtonClose.bind(this),this._handleOverlayClose=this._handleOverlayClose.bind(this),this._closeButton=this._popup.querySelector(".popup__close"),this._formList=[...this._popup.querySelectorAll(".popup__form")]}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleButtonClose(){this.close()}_handleOverlayClose(e){e.target===this._popup&&this.close()}open(){this._setEventListeners(),this._popup.classList.add("popup_open")}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keyup",this._handleEscClose),this._closeButton.removeEventListener("mouseup",this._handleButtonClose),this._popup.removeEventListener("mouseup",this._handleOverlayClose)}_setEventListeners(){document.addEventListener("keyup",this._handleEscClose),this._closeButton.addEventListener("mouseup",this._handleButtonClose),this._popup.addEventListener("mouseup",this._handleOverlayClose)}}class n extends r{constructor(e,t){var s,r;super(e),r=()=>{const e=this._getInputValues();this._handleFormSubmit(e,this._button)},(s="_handleSubmitClick")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._handleFormSubmit=t,this._formList=[...this._popup.querySelectorAll(".popup__form")],this._formEl=this._popup.querySelector(".popup__form"),this._button=this._popup.querySelector(".popup__button"),this._buttonOriginalText=this._button.textContent}_getInputValues(){const e=[...this._popup.querySelectorAll(".popup__info")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}_setEventListeners(){this._formList.forEach((e=>{e.addEventListener("submit",this._handleSubmitClick)})),super._setEventListeners()}close(){super.close(),this._formEl.removeEventListener("submit",this._handleSubmitClick)}renderLoading(e,t){e?(this._button.disabled=!0,this._button.textContent=t):(this._button.textContent=this._buttonOriginalText,this._button.disabled=!1)}}const i=document.querySelector(".profile__edit-icon"),o=document.querySelector(".profile__add-icon"),a=document.querySelector("#popup"),l=document.querySelector(".popup_picture"),h=document.querySelector(".popup_profile-pic"),c=document.querySelector("#form-field-author"),u=document.querySelector("#form-field-picture"),d=document.querySelector("#popup-name"),_=document.querySelector("#popup-title"),p=document.querySelector("#popup-profile-pic-url"),m=document.querySelector(".profile__pic-edit"),v=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}initialize(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}_handleFetchResponse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return fetch("".concat(this._baseUrl).concat(e),{method:t,headers:this._headers,body:s}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status))))}getInitialCards(){return this._handleFetchResponse("/cards")}getUserInfo(){return this._handleFetchResponse("/users/me")}editUserProfile(e){const t=JSON.stringify({name:e.name,about:e.about});return this._handleFetchResponse("/users/me","PATCH",t)}addNewCard(e){const t=JSON.stringify({name:e.name,link:e.link});return this._handleFetchResponse("/cards","POST",t)}getCardLikeInfo(){return this._handleFetchResponse("/cards")}deleteCard(e){return this._handleFetchResponse("/cards/".concat(e),"DELETE")}addLike(e){return this._handleFetchResponse("/cards/likes/".concat(e),"PUT")}removeLike(e){return this._handleFetchResponse("/cards/likes/".concat(e),"DELETE")}editProfilePic(e){const t=JSON.stringify({avatar:e.avatar});return this._handleFetchResponse("/users/me/avatar","PATCH",t)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"1384428a-b01c-46ae-afda-f222b9d7dc7d","Content-Type":"application/json"}});function S(e,t,s){"remove"===t?v.removeLike(e).then((e=>{s.updateLikes(e.likes)})).catch((e=>{alert(e)})):v.addLike(e).then((e=>{s.updateLikes(e.likes)})).catch((e=>{alert(e)}))}function b(e){const t=new class{constructor(e,t,s,r,n,i){this._imageLink=e.link,this._text=e.name,this._likes=e.likes,this._currentUserId=n,this._ownerId=e.owner._id,this._cardId=e._id,this._cardSelector=t,this._handleCardClick=s,this._handleTrashButton=r,this._handleLikeClick=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCardId(){return this._cardId}updateLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){this._likeCount.textContent=this._likes.length,this._isLiked()?this._heartButton.classList.add("card__heart_active"):this._heartButton.classList.remove("card__heart_active")}_isLiked(){return this._likes.some((e=>e._id===this._currentUserId))}_setEventListeners(){this._heartButton.addEventListener("mouseup",(()=>{this._heartButton.classList.contains("card__heart_active")?this._handleLikeClick(this._cardId,"remove",this):this._handleLikeClick(this._cardId,"add",this)})),this._trashButton&&this._trashButton.addEventListener("mouseup",(()=>{this._handleTrashButton(this)})),this._cardImage.addEventListener("mouseup",(e=>{this._handleCardClick(e.target)}))}deleteCard(){this._cardElement.remove(),this._cardElement=null}createCard(){this._cardElement=this._getTemplate(),this._cardImage=this._cardElement.querySelector(".card__img");const e=this._cardElement.querySelector(".card__place");return this._likeCount=this._cardElement.querySelector(".card__like-count"),this._trashButton=this._cardElement.querySelector(".card__trash"),this._heartButton=this._cardElement.querySelector(".card__heart"),this._cardImage.alt=this._text,this._cardImage.src=this._imageLink,e.textContent=this._text,this._ownerId!==this._currentUserId&&(this._trashButton.remove(),this._trashButton=null),this._setEventListeners(),this._renderLikes(),this._cardElement}}(e,"#card",g,C,U,S).createCard();y.addItem(t)}const f=new n(".popup_picture",(e=>{f.renderLoading(!0,"Creating..."),v.addNewCard(e).then((e=>{b(e),f.close()})).catch((e=>{alert(e)})).finally((()=>{f.renderLoading(!1,"Creating...")}))})),E=new class extends r{constructor(e){super(e)}open(e){const t=this._popup.querySelector(".popup__picture");t.src=e.src,t.alt=e.alt,this._popup.querySelector(".popup__popup-caption").textContent=e.alt,super.open()}}("#picture-popup");function g(e){E.open(e)}const L=new class extends r{constructor(e){super(e),this._button=this._popup.querySelector(".popup__button"),this._buttonOriginalText=this._button.textContent}setSubmit(e){this._handleFormSubmit=e}close(){super.close(),this._button.removeEventListener("mouseup",this._handleFormSubmit)}open(){super.open(),this._button.addEventListener("mouseup",this._handleFormSubmit)}renderLoading(e,t){e?(this._button.disabled=!0,this._button.textContent=t):(this._button.textContent=this._buttonOriginalText,this._button.disabled=!1)}}(".popup_delete");function C(e){L.setSubmit((()=>{L.renderLoading(!0,"Saving..."),v.deleteCard(e.getCardId()).then((()=>{e.deleteCard(),L.close()})).catch((e=>{alert(e)})).finally((()=>{L.renderLoading(!1,"Saving...")}))})),L.open()}let y=null;const k=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._nameSlot=document.querySelector(t),this._jobSlot=document.querySelector(s),this._avatarSlot=document.querySelector(r)}getUserInfo(){return{name:this._nameSlot.textContent,about:this._jobSlot.textContent,avatar:this._avatarSlot.src}}setUserInfo(e){this._nameSlot.textContent=e.name,this._jobSlot.textContent=e.about,this._avatarSlot.alt="".concat(e.name,"'s headshot"),this._avatarSlot.src=e.avatar}setUserAvatar(e){this._avatarSlot.src=e.avatar}}({nameSelector:".profile__name",jobSelector:".profile__title",avatarSelector:".profile__pic"}),I=new n("#popup",((e,t)=>{I.renderLoading(!0,"Saving..."),v.editUserProfile(e).then((e=>{k.setUserInfo(e),I.close()})).catch((e=>{alert(e)})).finally((()=>{I.renderLoading(!1,"Saving...")}))})),q=new n(".popup_profile-pic",((e,t)=>{q.renderLoading(!0,"Saving..."),v.editProfilePic(e).then((e=>{k.setUserAvatar(e),q.close()})).catch((e=>{alert(e)})).finally((()=>{q.renderLoading(!1,"Saving...")}))})),B=new t(e,a);B.enableValidator();const x=new t(e,l);x.enableValidator();const w=new t(e,h);w.enableValidator(),o.addEventListener("mouseup",(function(){u.reset(),x.resetValidation(),f.open()})),i.addEventListener("mouseup",(function(){c.reset(),function(){const e=k.getUserInfo();d.value=e.name,_.value=e.about}(),B.resetValidation(),I.open()})),m.addEventListener("mouseup",(function(){p.value=k.getUserInfo().avatar,w.resetValidation(),q.open()}));let U=null;v.initialize().then((e=>{let[t,r]=e;U=t._id,y=new s({items:r,renderer:b},".cards__container"),y.renderItems(),k.setUserInfo(t)})).catch((e=>{alert(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZeEIsTUFFdEI5QixPQUFPekIsSUFDTjBCLE1BQU0xQixNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL2Fyb3VuZF90aGVfdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kX3RoZV91cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2luZm9cIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJwb3B1cF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIC8vIGlucHV0IGxpbmUgZXJyb3Igc3R5bGVcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbmZvX3R5cGVfZXJyb3JcIixcbiAgLy8gZXJyb3IgbWVzc2FnZSBjbGFzc1xuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXG59O1xuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gXCIuY2FyZHNfX2NvbnRhaW5lclwiO1xuZXhwb3J0IGNvbnN0IGNhcmRTZWxlY3RvciA9IFwiI2NhcmRcIjtcbiIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsKSB7XG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KSB7XG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICB9XG4gIF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIF9oYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PlxuICAgIGlucHV0TGlzdC5zb21lKChpbnB1dEVsKSA9PiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICAvLyBjaGFuZ2UgdGVoIGlucHV0IHN0eWxlIHVwb24gZXJyb3JcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICAvLyBlcnJvciBtZXNzYWdlIGNvbnRlbnRcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIC8vIGFjY2VzcyB0aGUgaW5wdXQgaWQgd2hpY2ggaXMgc29tZXRoaW5nIGxpa2UgcG9wdXAtZGVzY3JpcHRpb25cbiAgICBjb25zdCBpbnB1dElkID0gaW5wdXRFbC5pZDtcbiAgICAvLyB0aGUgaWQgb2YgdGhlIHNwYW4gc2xvdCBpcyB0aGUgdGVtcGxhdGUgbGl0ZXJhbFxuICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRJZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsLnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcbiAgfVxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGNvbnN0IGlucHV0SWQgPSBpbnB1dEVsLmlkO1xuICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRJZH0tZXJyb3JgKTtcbiAgICBlcnJvckVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvckVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH1cbiAgZW5hYmxlVmFsaWRhdG9yKCkge1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IFtcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpLFxuICAgIF07XG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICAgIC8vIHByZXZlbnQgYWxsIGZvcm1zIGZyb20gcmVmcmVzaGluZyB0aGUgcGFnZSB1cG9uIHN1Ym1pdFxuICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgLy8gZm9yIGFsbCBmb3Jtcywgd2UgbmVlZCB0byBzZXQgZXZlbnQgbGlzdGVuZXJzXG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcbiAgfVxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gW1xuICAgICAgLi4udGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvciksXG4gICAgXTtcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkgPSBpdGVtcztcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICB9XG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheS5mb3JFYWNoKChhcnJFbCkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoYXJyRWwpO1xuICAgIH0pO1xuICB9XG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZUJ1dHRvbkNsb3NlID0gdGhpcy5faGFuZGxlQnV0dG9uQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UgPSB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpO1xuICAgIHRoaXMuX2Zvcm1MaXN0ID0gWy4uLnRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2Zvcm1cIildO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG4gIF9oYW5kbGVCdXR0b25DbG9zZSgpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH1cbiAgX2hhbmRsZU92ZXJsYXlDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gdGhpcy5fcG9wdXApIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5cIik7XG4gIH1cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5cIik7XG5cbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuX2hhbmRsZUJ1dHRvbkNsb3NlKTtcbiAgICB0aGlzLl9wb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIFRocmVlIHdheXMgdG8gY2xvc2UgdGhlIHBvcHVwOlxuICAgIC8vIDEpIGhpdCBFU0Mga2V5XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICAvLyAyKSBtb3VzZXVwIG9uIHRoZSBjbG9zZSBidXR0b25cbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLl9oYW5kbGVCdXR0b25DbG9zZSk7XG4gICAgLy8gMykgbW91c2V1cCBvbiB0aGUgb3ZlcmxheVxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXlDbG9zZSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUxpc3QgPSBbLi4udGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9fZm9ybVwiKV07XG4gICAgdGhpcy5fZm9ybUVsID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcbiAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XG4gICAgdGhpcy5fYnV0dG9uT3JpZ2luYWxUZXh0ID0gdGhpcy5fYnV0dG9uLnRleHRDb250ZW50O1xuICB9XG4gIC8vIGNyZWF0ZSBhbmQgcmV0dXJuIGFuIG9iamVjdCBmcm9tIGFsbCB0aGUgaW5wdXQgYm94ZXMnIGFuc3dlcnNcbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IFsuLi50aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwX19pbmZvXCIpXTtcbiAgICBjb25zdCBpbnB1dENvbnRlbnQgPSB7fTtcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRDb250ZW50W2lucHV0RWwubmFtZV0gPSBpbnB1dEVsLnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dENvbnRlbnQ7XG4gIH1cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xuICAgICAgZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0Q2xpY2spO1xuICAgIH0pO1xuXG4gICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbiAgX2hhbmRsZVN1Ym1pdENsaWNrID0gKCkgPT4ge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICAvL3dhaXQgdG8gYmUgcGFzc2VkIGluIGluIGluZGV4LmpzXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChpbnB1dFZhbHVlcywgdGhpcy5fYnV0dG9uKTtcbiAgfTtcbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVTdWJtaXRDbGljayk7XG4gIH1cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGJ1dHRvblRleHQpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fYnV0dG9uT3JpZ2luYWxUZXh0O1xuICAgICAgdGhpcy5fYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xuaW1wb3J0IHsgY2FyZHNDb250YWluZXIsIGNhcmRTZWxlY3Rvciwgc2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZVwiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvblwiO1xuXG4vLyBwcm9maWxlIGljb25zXG5jb25zdCBlZGl0UHJvZmlsZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtaWNvblwiKTtcbmNvbnN0IGFkZFBpY3R1cmVJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtaWNvblwiKTtcbi8vIGF1dGhvciwgYWRkIHBpY3R1cmUgZm9ybXNcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcG9wdXBcIik7XG5jb25zdCBhZGRQaWN0dXJlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfcGljdHVyZVwiKTtcbmNvbnN0IGVkaXRQcm9maWxlUGljRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfcHJvZmlsZS1waWNcIik7XG4vLyBmb3JtIGZpZWxkcyBmb3IgdGhlIGF1dGhvciBmb3JtIGFuZCB0aGUgYWRkIHBpY3R1cmUgZm9ybVxuY29uc3QgZm9ybUZpZWxkQXV0aG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtLWZpZWxkLWF1dGhvclwiKTtcbmNvbnN0IGZvcm1GaWVsZFBpY3R1cmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Zvcm0tZmllbGQtcGljdHVyZVwiKTtcbi8vIGlucHV0IGZpZWxkcyBmb3IgcHJvZmlsZSBmb3JtIHBvcHVwXG5jb25zdCBpbnB1dFByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwb3B1cC1uYW1lXCIpO1xuY29uc3QgaW5wdXRQcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLXRpdGxlXCIpO1xuLy8gcHJvZmlsZSBzZWN0aW9uIG9uIHRoZSBwYWdlXG5jb25zdCBwcm9maWxlUGljSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLXByb2ZpbGUtcGljLXVybFwiKTtcbmNvbnN0IGVkaXRQcm9maWxlUGljSWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGljLWVkaXRcIik7XG5cbi8vIGluc3RhbnRpYXRlIEFQSSBjbGFzc1xuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIxMzg0NDI4YS1iMDFjLTQ2YWUtYWZkYS1mMjIyYjlkN2RjN2RcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBoYW5kbGUgTGlrZSBDbGljayBmdW5jdGlvbiBwYXNzZWQgaW4gYXMgY2FsbGJhY2sgdG8gQ2FyZC5qc1xuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmRJZCwgYWN0aW9uLCBjYXJkKSB7XG4gIGlmIChhY3Rpb24gPT09IFwicmVtb3ZlXCIpIHtcbiAgICBhcGlcbiAgICAgIC5yZW1vdmVMaWtlKGNhcmRJZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgocmVzKSA9PiB7XG4gICAgICAgIGFsZXJ0KHJlcyk7XG4gICAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBhcGlcbiAgICAgIC5hZGRMaWtlKGNhcmRJZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgocmVzKSA9PiB7XG4gICAgICAgIGFsZXJ0KHJlcyk7XG4gICAgICB9KTtcbiAgfVxufVxuXG4vLyBhZGQgcGljdHVyZSBmb3JtIGZ1bmN0aW9uc1xuZnVuY3Rpb24gcmVuZGVyQ2FyZChpbnB1dFZhbHVlcykge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgaW5wdXRWYWx1ZXMsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVUcmFzaEJ1dHRvbixcbiAgICBjdXJyZW50VXNlcklkLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApO1xuICBjb25zdCBjYXJkRWwgPSBjYXJkLmNyZWF0ZUNhcmQoKTtcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWwpO1xufVxuXG4vLyBhZGQgcGljdHVyZSBmb3JtIHN1Ym1pdFxuY29uc3QgcGxhY2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnBvcHVwX3BpY3R1cmVcIiwgKGlucHV0VmFsdWVzKSA9PiB7XG4gIHBsYWNlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlLCBcIkNyZWF0aW5nLi4uXCIpO1xuICBhcGlcbiAgICAuYWRkTmV3Q2FyZChpbnB1dFZhbHVlcylcbiAgICAudGhlbigoaW5wdXRWYWx1ZXMpID0+IHtcbiAgICAgIHJlbmRlckNhcmQoaW5wdXRWYWx1ZXMpO1xuICAgICAgcGxhY2VQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChyZXMpID0+IHtcbiAgICAgIGFsZXJ0KHJlcyk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwbGFjZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UsIFwiQ3JlYXRpbmcuLi5cIik7XG4gICAgfSk7XG59KTtcblxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwaWN0dXJlLXBvcHVwXCIpO1xuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGltYWdlKSB7XG4gIGltYWdlUG9wdXAub3BlbihpbWFnZSk7XG59XG5cbmNvbnN0IGRlbGV0ZUNhcmRDb25maXJtYXRpb24gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiLnBvcHVwX2RlbGV0ZVwiKTtcblxuLy8gdG8gaW50ZXJhY3Qgd2l0aCB0aGUgQ2FyZCBjbGFzcywgb3BlbiBwb3B1cCwgdGhlbiB3YWl0IGZvciBkZWxldGUgdG8gY29tcGxldGVcbmZ1bmN0aW9uIGhhbmRsZVRyYXNoQnV0dG9uKGNhcmQpIHtcbiAgZGVsZXRlQ2FyZENvbmZpcm1hdGlvbi5zZXRTdWJtaXQoKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRDb25maXJtYXRpb24ucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuZ2V0Q2FyZElkKCkpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuZGVsZXRlQ2FyZCgpO1xuICAgICAgICBkZWxldGVDYXJkQ29uZmlybWF0aW9uLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChyZXMpID0+IHtcbiAgICAgICAgYWxlcnQocmVzKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNhcmRDb25maXJtYXRpb24ucmVuZGVyTG9hZGluZyhmYWxzZSwgXCJTYXZpbmcuLi5cIik7XG4gICAgICB9KTtcbiAgfSk7XG4gIGRlbGV0ZUNhcmRDb25maXJtYXRpb24ub3BlbigpO1xufVxuXG4vLyBpbml0aWFsaXplIGNhcmQgU2VjdGlvbiBjbGFzcyB2YXJpYWJsZSB0byB0YWtlIGFwaSBjYWxsIHJlc3VsdCBhbmQgaW50ZXJhY3Qgd2l0aCBTZWN0aW9uLmpzXG5sZXQgY2FyZFNlY3Rpb24gPSBudWxsO1xuXG4vLyBwcm9maWxlIGZvcm0gZnVuY3Rpb25zXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XG4gIGNvbnN0IHJlc3VsdCA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGlucHV0UHJvZmlsZU5hbWUudmFsdWUgPSByZXN1bHQubmFtZTtcbiAgaW5wdXRQcm9maWxlVGl0bGUudmFsdWUgPSByZXN1bHQuYWJvdXQ7XG59XG5mdW5jdGlvbiBoYW5kbGVPcGVuUHJvZmlsZUZvcm0oKSB7XG4gIGZvcm1GaWVsZEF1dGhvci5yZXNldCgpO1xuICBmaWxsUHJvZmlsZUZvcm0oKTtcbiAgYWRkUHJvZmlsZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHByb2ZpbGVQb3B1cC5vcGVuKCk7XG59XG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX3BpY1wiLFxufSk7XG5jb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwb3B1cFwiLCAoaW5wdXRWYWx1ZXMsIGJ1dHRvbikgPT4ge1xuICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcbiAgYXBpXG4gICAgLmVkaXRVc2VyUHJvZmlsZShpbnB1dFZhbHVlcylcbiAgICAudGhlbigoaW5wdXRWYWx1ZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGlucHV0VmFsdWVzKTtcbiAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChyZXMpID0+IHtcbiAgICAgIGFsZXJ0KHJlcyk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSwgXCJTYXZpbmcuLi5cIik7XG4gICAgfSk7XG59KTtcblxuY29uc3QgcHJvZmlsZVBpY1BvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiLnBvcHVwX3Byb2ZpbGUtcGljXCIsXG4gIChpbnB1dFZhbHVlcywgYnV0dG9uKSA9PiB7XG4gICAgcHJvZmlsZVBpY1BvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XG4gICAgYXBpXG4gICAgICAuZWRpdFByb2ZpbGVQaWMoaW5wdXRWYWx1ZXMpXG4gICAgICAudGhlbigoaW5wdXRWYWx1ZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihpbnB1dFZhbHVlcyk7XG4gICAgICAgIHByb2ZpbGVQaWNQb3B1cC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgocmVzKSA9PiB7XG4gICAgICAgIGFsZXJ0KHJlcyk7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBwcm9maWxlUGljUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSwgXCJTYXZpbmcuLi5cIik7XG4gICAgICB9KTtcbiAgfVxuKTtcblxuLy8gdmFsaWRhdG9yc1xuY29uc3QgYWRkUHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZWRpdFByb2ZpbGVGb3JtKTtcbmFkZFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRvcigpO1xuY29uc3QgYWRkUGljdHVyZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkUGljdHVyZUZvcm0pO1xuYWRkUGljdHVyZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdG9yKCk7XG5jb25zdCBlZGl0UHJvZmlsZVBpY0Zvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgc2V0dGluZ3MsXG4gIGVkaXRQcm9maWxlUGljRm9ybVxuKTtcbmVkaXRQcm9maWxlUGljRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0b3IoKTtcblxuZnVuY3Rpb24gaGFuZGxlT3BlbkFkZFBpY3R1cmVGb3JtKCkge1xuICBmb3JtRmllbGRQaWN0dXJlLnJlc2V0KCk7XG5cbiAgYWRkUGljdHVyZUZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHBsYWNlUG9wdXAub3BlbigpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVPcGVuRWRpdFByb2ZpbGVQaWNGb3JtKCkge1xuICBwcm9maWxlUGljSW5wdXQudmFsdWUgPSB1c2VySW5mby5nZXRVc2VySW5mbygpLmF2YXRhcjtcbiAgZWRpdFByb2ZpbGVQaWNGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBwcm9maWxlUGljUG9wdXAub3BlbigpO1xufVxuYWRkUGljdHVyZUljb24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgaGFuZGxlT3BlbkFkZFBpY3R1cmVGb3JtKTtcbmVkaXRQcm9maWxlSWNvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBoYW5kbGVPcGVuUHJvZmlsZUZvcm0pO1xuZWRpdFByb2ZpbGVQaWNJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGhhbmRsZU9wZW5FZGl0UHJvZmlsZVBpY0Zvcm0pO1xuXG5sZXQgY3VycmVudFVzZXJJZCA9IG51bGw7XG5hcGlcbiAgLmluaXRpYWxpemUoKVxuICAudGhlbigoW3VzZXIsIGNhcmRzXSkgPT4ge1xuICAgIGN1cnJlbnRVc2VySWQgPSB1c2VyLl9pZDtcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZHMsXG4gICAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICAgICAgfSxcbiAgICAgIGNhcmRzQ29udGFpbmVyXG4gICAgKTtcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlcik7XG4gIH0pXG4gIC5jYXRjaCgocmVzKSA9PiB7XG4gICAgYWxlcnQocmVzKTtcbiAgfSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG4gIGluaXRpYWxpemUoKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcbiAgfVxuICBfaGFuZGxlRmV0Y2hSZXNwb25zZShwYXRoLCBtZXRob2RVc2VkID0gXCJHRVRcIiwgYm9keUNvbnRlbnQgPSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0ke3BhdGh9YCwge1xuICAgICAgbWV0aG9kOiBtZXRob2RVc2VkLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IGJvZHlDb250ZW50LFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZUZldGNoUmVzcG9uc2UoXCIvY2FyZHNcIik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZUZldGNoUmVzcG9uc2UoXCIvdXNlcnMvbWVcIik7XG4gIH1cbiAgZWRpdFVzZXJQcm9maWxlKGlucHV0VmFsdWVzKSB7XG4gICAgY29uc3QgYm9keUNvbnRlbnQgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgICAgYWJvdXQ6IGlucHV0VmFsdWVzLmFib3V0LFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVGZXRjaFJlc3BvbnNlKFwiL3VzZXJzL21lXCIsIFwiUEFUQ0hcIiwgYm9keUNvbnRlbnQpO1xuICB9XG4gIGFkZE5ld0NhcmQoaW5wdXRWYWx1ZXMpIHtcbiAgICBjb25zdCBib2R5Q29udGVudCA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXG4gICAgICBsaW5rOiBpbnB1dFZhbHVlcy5saW5rLFxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVGZXRjaFJlc3BvbnNlKFwiL2NhcmRzXCIsIFwiUE9TVFwiLCBib2R5Q29udGVudCk7XG4gIH1cbiAgZ2V0Q2FyZExpa2VJbmZvKCkge1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVGZXRjaFJlc3BvbnNlKFwiL2NhcmRzXCIpO1xuICB9XG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZUZldGNoUmVzcG9uc2UoYC9jYXJkcy8ke2NhcmRJZH1gLCBcIkRFTEVURVwiKTtcbiAgfVxuXG4gIGFkZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX2hhbmRsZUZldGNoUmVzcG9uc2UoYC9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCBcIlBVVFwiKTtcbiAgfVxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9oYW5kbGVGZXRjaFJlc3BvbnNlKGAvY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwgXCJERUxFVEVcIik7XG4gIH1cbiAgZWRpdFByb2ZpbGVQaWMoYXZhdGFyTGluaykge1xuICAgIGNvbnN0IGJvZHlDb250ZW50ID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgYXZhdGFyOiBhdmF0YXJMaW5rLmF2YXRhcixcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5faGFuZGxlRmV0Y2hSZXNwb25zZShcIi91c2Vycy9tZS9hdmF0YXJcIiwgXCJQQVRDSFwiLCBib2R5Q29udGVudCk7XG4gIH1cbn1cbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBjYXJkRGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZVRyYXNoQnV0dG9uLFxuICAgIGN1cnJlbnRVc2VySWQsXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX2ltYWdlTGluayA9IGNhcmREYXRhLmxpbms7XG4gICAgdGhpcy5fdGV4dCA9IGNhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fbGlrZXMgPSBjYXJkRGF0YS5saWtlcztcbiAgICB0aGlzLl9jdXJyZW50VXNlcklkID0gY3VycmVudFVzZXJJZDtcbiAgICB0aGlzLl9vd25lcklkID0gY2FyZERhdGEub3duZXIuX2lkO1xuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmREYXRhLl9pZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZVRyYXNoQnV0dG9uID0gaGFuZGxlVHJhc2hCdXR0b247XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuICBnZXRDYXJkSWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRJZDtcbiAgfVxuICB1cGRhdGVMaWtlcyhsaWtlcykge1xuICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG4gICAgaWYgKHRoaXMuX2lzTGlrZWQoKSkge1xuICAgICAgdGhpcy5faGVhcnRCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2hlYXJ0X2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGVhcnRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2hlYXJ0X2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cbiAgX2lzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKHVzZXIpID0+IHtcbiAgICAgIHJldHVybiB1c2VyLl9pZCA9PT0gdGhpcy5fY3VycmVudFVzZXJJZDtcbiAgICB9KTtcbiAgfVxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faGVhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuX2hlYXJ0QnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2hlYXJ0X2FjdGl2ZVwiKSkge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5fY2FyZElkLCBcInJlbW92ZVwiLCB0aGlzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9jYXJkSWQsIFwiYWRkXCIsIHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMuX3RyYXNoQnV0dG9uKSB7XG4gICAgICB0aGlzLl90cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZVRyYXNoQnV0dG9uKHRoaXMpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIChldnQpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayhldnQudGFyZ2V0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xuICB9XG4gIGNyZWF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1nXCIpO1xuICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fcGxhY2VcIik7XG4gICAgdGhpcy5fbGlrZUNvdW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50XCIpO1xuICAgIHRoaXMuX3RyYXNoQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaFwiKTtcbiAgICB0aGlzLl9oZWFydEJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faGVhcnRcIik7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fdGV4dDtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5faW1hZ2VMaW5rO1xuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XG5cbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fY3VycmVudFVzZXJJZCkge1xuICAgICAgdGhpcy5fdHJhc2hCdXR0b24ucmVtb3ZlKCk7XG4gICAgICB0aGlzLl90cmFzaEJ1dHRvbiA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICB9XG4gIG9wZW4oaW1hZ2UpIHtcbiAgICBjb25zdCBpbWFnZUVsID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcGljdHVyZVwiKTtcbiAgICBpbWFnZUVsLnNyYyA9IGltYWdlLnNyYztcbiAgICBpbWFnZUVsLmFsdCA9IGltYWdlLmFsdDtcbiAgICBjb25zdCBjYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fcG9wdXAtY2FwdGlvblwiKTtcbiAgICBjYXB0aW9uLnRleHRDb250ZW50ID0gaW1hZ2UuYWx0O1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2J1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9idXR0b25PcmlnaW5hbFRleHQgPSB0aGlzLl9idXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRTdWJtaXQoaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIC8vd2FpdCB0byBiZSBwYXNzZWQgaW4gaW4gaW5kZXguanNcbiAgfVxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2J1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KTtcbiAgfVxuICBvcGVuKCkge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICB0aGlzLl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCk7XG4gIH1cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGJ1dHRvblRleHQpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fYnV0dG9uT3JpZ2luYWxUZXh0O1xuICAgICAgdGhpcy5fYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVTbG90ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYlNsb3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJTbG90ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgLy8gdG8gcG9wdWxhdGUgZm9ybSBmaWVsZHMgYWZ0ZXIgcG9wdXAgb3BlblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZVNsb3QudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fam9iU2xvdC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyU2xvdC5zcmMsXG4gICAgfTtcbiAgfVxuICAvLyB1cG9uIGZvcm0gc3VibWlzc2lvblxuICBzZXRVc2VySW5mbyhkYXRhKSB7XG4gICAgdGhpcy5fbmFtZVNsb3QudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fam9iU2xvdC50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XG4gICAgdGhpcy5fYXZhdGFyU2xvdC5hbHQgPSBgJHtkYXRhLm5hbWV9J3MgaGVhZHNob3RgO1xuICAgIHRoaXMuX2F2YXRhclNsb3Quc3JjID0gZGF0YS5hdmF0YXI7XG4gIH1cbiAgc2V0VXNlckF2YXRhcihkYXRhKSB7XG4gICAgdGhpcy5fYXZhdGFyU2xvdC5zcmMgPSBkYXRhLmF2YXRhcjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInNldHRpbmdzIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjb25zdHJ1Y3RvciIsImZvcm1FbCIsImlucHV0TGlzdCIsInNvbWUiLCJpbnB1dEVsIiwidmFsaWRpdHkiLCJ2YWxpZCIsInRoaXMiLCJfc2V0dGluZ3MiLCJfZm9ybUVsIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYnV0dG9uRWxlbWVudCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsImNsYXNzTGlzdCIsImFkZCIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRJZCIsImlkIiwiZXJyb3JFbCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsInJlbW92ZSIsImVuYWJsZVZhbGlkYXRvciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaW5pdGlhbEFycmF5IiwiX2NvbnRhaW5lciIsImRvY3VtZW50IiwiX3JlbmRlcmVyIiwicmVuZGVySXRlbXMiLCJhcnJFbCIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJfaGFuZGxlQnV0dG9uQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsb3NlIiwiX2Nsb3NlQnV0dG9uIiwiX2Zvcm1MaXN0Iiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJpbnB1dFZhbHVlcyIsIl9nZXRJbnB1dFZhbHVlcyIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2J1dHRvbiIsIl9idXR0b25PcmlnaW5hbFRleHQiLCJpbnB1dENvbnRlbnQiLCJuYW1lIiwidmFsdWUiLCJfaGFuZGxlU3VibWl0Q2xpY2siLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnV0dG9uVGV4dCIsImVkaXRQcm9maWxlSWNvbiIsImFkZFBpY3R1cmVJY29uIiwiZWRpdFByb2ZpbGVGb3JtIiwiYWRkUGljdHVyZUZvcm0iLCJlZGl0UHJvZmlsZVBpY0Zvcm0iLCJmb3JtRmllbGRBdXRob3IiLCJmb3JtRmllbGRQaWN0dXJlIiwiaW5wdXRQcm9maWxlTmFtZSIsImlucHV0UHJvZmlsZVRpdGxlIiwicHJvZmlsZVBpY0lucHV0IiwiZWRpdFByb2ZpbGVQaWNJY29uIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiaW5pdGlhbGl6ZSIsIlByb21pc2UiLCJhbGwiLCJnZXRVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsIl9oYW5kbGVGZXRjaFJlc3BvbnNlIiwicGF0aCIsIm1ldGhvZFVzZWQiLCJib2R5Q29udGVudCIsInVuZGVmaW5lZCIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJlZGl0VXNlclByb2ZpbGUiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGROZXdDYXJkIiwibGluayIsImdldENhcmRMaWtlSW5mbyIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImVkaXRQcm9maWxlUGljIiwiYXZhdGFyTGluayIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJoYW5kbGVMaWtlQ2xpY2siLCJhY3Rpb24iLCJjYXJkIiwidXBkYXRlTGlrZXMiLCJsaWtlcyIsImNhdGNoIiwiYWxlcnQiLCJyZW5kZXJDYXJkIiwiY2FyZEVsIiwiY2FyZERhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVUcmFzaEJ1dHRvbiIsImN1cnJlbnRVc2VySWQiLCJfaW1hZ2VMaW5rIiwiX3RleHQiLCJfbGlrZXMiLCJfY3VycmVudFVzZXJJZCIsIl9vd25lcklkIiwib3duZXIiLCJfaWQiLCJfY2FyZElkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlVHJhc2hCdXR0b24iLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldENhcmRJZCIsIl9yZW5kZXJMaWtlcyIsIl9saWtlQ291bnQiLCJsZW5ndGgiLCJfaXNMaWtlZCIsIl9oZWFydEJ1dHRvbiIsInVzZXIiLCJjb250YWlucyIsIl90cmFzaEJ1dHRvbiIsIl9jYXJkSW1hZ2UiLCJfY2FyZEVsZW1lbnQiLCJjcmVhdGVDYXJkIiwiY2FyZFRpdGxlIiwiYWx0Iiwic3JjIiwiY2FyZFNlY3Rpb24iLCJwbGFjZVBvcHVwIiwiZmluYWxseSIsImltYWdlUG9wdXAiLCJpbWFnZSIsImltYWdlRWwiLCJkZWxldGVDYXJkQ29uZmlybWF0aW9uIiwic2V0U3VibWl0IiwidXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVTbG90IiwiX2pvYlNsb3QiLCJfYXZhdGFyU2xvdCIsInNldFVzZXJJbmZvIiwiZGF0YSIsInNldFVzZXJBdmF0YXIiLCJwcm9maWxlUG9wdXAiLCJidXR0b24iLCJwcm9maWxlUGljUG9wdXAiLCJhZGRQcm9maWxlRm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRQaWN0dXJlRm9ybVZhbGlkYXRvciIsImVkaXRQcm9maWxlUGljRm9ybVZhbGlkYXRvciIsInJlc2V0IiwicmVzdWx0IiwiZmlsbFByb2ZpbGVGb3JtIiwiY2FyZHMiXSwic291cmNlUm9vdCI6IiJ9